build_script:
  - set CXXFLAGS=%FLAGS%
  - cd test
  - mkdir build
  - cd build
  - cmake .. -G "%CMAKE_GENERATOR%" -A %ARCH%
  - cmake --build . --config %CONFIGURATION%

test_script:
  - .\%CONFIGURATION%\momo_test.exe

environment:
  matrix:

    - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2015
      CMAKE_GENERATOR: Visual Studio 14 2015
      CONFIGURATION: Debug
      ARCH: x64
      FLAGS: "/WX"

    - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2015
      CMAKE_GENERATOR: Visual Studio 14 2015
      CONFIGURATION: Release
      ARCH: x64
      FLAGS: "/WX"

    - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2015
      CMAKE_GENERATOR: Visual Studio 14 2015
      CONFIGURATION: Release
      ARCH: Win32
      FLAGS: "/WX"

    - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2017
      CMAKE_GENERATOR: Visual Studio 15 2017
      CONFIGURATION: Release
      ARCH: x64
      FLAGS: "/std:c++17 /WX /permissive- /Zc:__cplusplus"

#    - APPVEYOR_BUILD_WORKER_IMAGE: Visual Studio 2017
#      CMAKE_GENERATOR: Visual Studio 15 2017
#      CONFIGURATION: Release
#      ARCH: Win32
#      FLAGS: "/std:c++17 /WX /permissive- /Zc:__cplusplus"
